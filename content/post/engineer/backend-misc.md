---
title: "工程技术：后端合集"
date: 2023-12-06T13:14:26+08:00
categories:
- 开发
- 工程实现
tags:
- 工程实现
- 后端
- 滚动更新
thumbnailImagePosition: left
thumbnailImage: /images/thumbnail/engineer.png

---
本文记录一些在后端开发中常见的一些工程技术，用来提高稳定性，提高性能等。可能是一些设计思路或实现范式。
<!--more-->
## 流量限制算法
1. 漏桶：以绝对固定的速率接受请求并进行处理，像是一个桶以固定的速率漏水一样
1. 令牌桶：以固定的速率向桶内放令牌，拿到令牌的请求可以进行处理，因此能够接受一定量的大并发
1. 参考：
    - [高并发系统限流-漏桶算法和令牌桶算法](https://www.cnblogs.com/xuwc/p/9123078.html)‘

## 时间轮算法
时间轮不止在后端（Quartz等）中有使用，也是在Linux等系统层面，必不可少的定时器算法。

基本原理
1. 建立若干个环状数据结构（多级时间轮，表示不同精度的时间循环）
    1. 常用的时间是年月日时分秒，可以看作是6级的时间轮。
2. 每个数据结构中的元素，代表一个时间刻度，对应一个时间范围。并由于其可能对应多个任务，需要建立链表。
3. 对于定时任务，计算其时间距离，挂载到对应的元素的链表中

下面给出一个，对于时间轮和任务元素的基本封装示例
```cpp
/**
 * 时间轮需要表示的内容
 *
 * 精度（时间间隔）
 * 所用的系统定时器实例
 * 循环数据结构（元素是链表等方式存储）
 * 辅助Map（定时任务key-链表地址） 
 */

/**
 * 任务元素
 *
 * 还有几轮才能开始执行
 * 待执行任务（例如闭包函数）
 */
```

进一步的，我们可以把单机版的多级时间轮，修改为分布式的多级时间轮。比如用Redis的ZSet存储定时任务，并不断查询。

参考：
    - [Bilibili 时间轮算法原理与实战](https://www.bilibili.com/video/BV1k8411r7E4)
    - [Hashed and Hierarchical Timing Wheels论文](https://dl.acm.org/doi/pdf/10.1145/41457.37504) 