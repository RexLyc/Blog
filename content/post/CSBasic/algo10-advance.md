---
title: "算法导论其十：进阶篇"
date: 2023-12-06T11:04:53+08:00
categories:
- 计算机科学与技术
- 算法
tags:
- 算法系列
- 滚动更新
thumbnailImagePosition: left
thumbnailImage: /images/thumbnail/algorithm.jpg
math: true
draft: true
---
本章节将会聚焦一些经典问题，以及经典进阶算法。在追求高效率的路上是没有极限的。
<!--more-->
## 经典问题
### RMQ区间最大值最小值查询
问题描述：在一个给定区间中，查询区间内的最大值或最小值
- Tarjan的Sparse-Table算法
    - 构建：$dp[i][j]$表示i为起点，长度为$2^j$的区间的最值。状态转移方程（可以理解为二分）为$dp[i][j]=min/max(dp[i][j-1]+dp[i+(1<<(j-1))][j-1])$。注意二层循环，j为外层（按照区间长度分治）。
    - 查询：寻找小于等于区间范围的区间（或多个区间，可以重叠）。
    - 复杂度：$O(nlogn)$建立，$O(1)$查询
- 线段树：$O(n)$建立，$O(logn)$查询
- 笛卡尔树+LCA+DP：$O(n)$建立，$O(1)$查询

### LCA最近公共祖先
问题描述：在一棵树中，求任意两个节点的祖先中，深度最大的那个。LCA问题往往会同时输入多个查询。
- 朴素算法：
    - 描述：将两个节点中深度较大的一个先向树根上跳，直到二者深度一致。然后再共同上跳，直到相遇。
    - 复杂度：$O(H)$，考虑到$m$次查询，则整体复杂度为$O(H*m)$，$H$为树的高度。
- 倍增算法：
    - 描述：建立一个跳转表，加速朴素算法两个阶段的上跳过程。
        - 跳转表：和RMQ问题中的ST表非常类似，令$f[i][j]$代表点$i$的第$2^j$个祖先，则$f[i][j]=f[f[i][j-1]][j-1]$。（爸爸的爸爸是爷爷）
        - 建立跳转表：dfs遍历，每个节点利用父节点已经保存的祖先信息计算。另外在dfs时顺便保存每个节点的深度信息。
        - 第一阶段上跳：每一次上跳尽量多且不超过另一个节点的深度
        - 第二阶段上跳：两节点上跳到父节点相等，但当前节点不相等。如果上跳过程中两个节点跳后相等，则是跳多了。
    - 复杂度：预处理$O(nlog n)$，单次查询为$O(log n)$，整体为$O(n log n + m log n)$
- 欧拉序列转RMQ问题：
    - 描述：将树转换为欧拉序列，并保存对应的深度信息，再对序列求RMQ问题
        - 欧拉序列：按照dfs顺序，当前节点开始访问和结束访问时都记录到序列中，相当于“根左右根”，序列长度为$2n$
        - 欧拉序列性质：树上的两点，其最终在欧拉序列中的两个位置（只取节点第一次加入的位置），两个位置之间，深度最小值就是其LCA
    - 复杂度：由所使用的RMQ算法决定
- Tarjan算法：
    - 描述：考虑一个节点的左右子树，如果一个查询分别位于两个子树上，则LCA一定就是当前的节点。如果用并查集来合并保存节点之间的祖先关系，那么这种查询就能在$O(1)$时间内完成。
        - 建立初始并查集（孤立点），并为每一个节点记录所有相关查询
        - 遍历：从根开始DFS遍历每一个节点
            - 检查当前节点是否有查询请求
                - 有，且另一个节点标记为已处理，则另一个节点的并查集祖先就是当前查询的LCA
                - 有，且另一个节点未处理，暂时跳过
            - 如果存在子节点未访问，对其递归
                - 任意子节点递归返回时，都将其并查集合并到当前节点，即以当前节点为子节点的并查集祖先
            - 不存在子节点，直接返回
    - 复杂度：建立数据结构花费$O(n)$，$n$为节点数，单次查询为$O(1)$，整体为$O(n+m)$。
    - 扩展：
        - 求树上两点路径：Tarjan算法在使用的过程中，一个查询中，已处理节点的并查集路径和当前节点的各级父节点就是两点之间的路径
- 扩展
    - LCA和树差分：求一个带权树上两点之间的距离。其距离等于两点到根的距离之和，减去两倍的两点LCA到根的距离。
- 参考：[最近公共祖先 LCA 算法详解- 朴素、在线、离线](https://blog.csdn.net/qq_43332980/article/details/107437070)、[Bilibili推荐：【算法】LCA&RMQ&树差分——保姆级教程](https://www.bilibili.com/video/BV1nE411L7rz)